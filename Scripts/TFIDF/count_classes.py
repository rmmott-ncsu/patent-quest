import pandas as pd
from CPC_codes import CPC_CODES
import operator
import csv


def get_count_of_cpc(path: str) -> dict:
    df = pd.read_csv(path)
    cpc_counts = {}

    for index, row in df.iterrows():
        for cpc in CPC_CODES:
            try:
                if cpc in row['cpc_subclass_id']:
                    try:
                        cpc_counts[cpc] += 1
                    except KeyError:
                        cpc_counts[cpc] = 0
            except TypeError:
                print(row['cpc_subclass_id'])

    return cpc_counts
# Ex. count_dict = {'G06V': 10328, 'G06T': 14603, 'A01G': 902, 'A01D': 660, 'A01M': 440, 'A01B': 541, 'G01L': 1372, 'G01G': 394, 'F04B': 1287, 'A01C': 484, 'F15B': 893, 'G05D': 4470, 'B62D': 2969, 'H04L': 40713, 'G06F': 62497, 'Y02P': 6658, 'G01N': 11811, 'F16H': 3192, 'A01F': 220, 'A23N': 87, 'Y02A': 3302, 'B25J': 2271, 'H05B': 3652, 'A01K': 1471, 'A47G': 939, 'B66F': 435, 'B65G': 1933, 'G05B': 5427, 'C12M': 790, 'B01D': 4901, 'A01H': 1224, 'C12N': 6214, 'B65D': 3735, 'E05F': 607, 'E05Y': 977, 'A47B': 1116, 'A63B': 2423, 'A61K': 14313, 'C02F': 1742, 'C07K': 5226, 'G08B': 3300, 'G06N': 8084, 'G01S': 5657, 'G10K': 764, 'G02B': 12582, 'G01V': 1532, 'A01N': 1274, 'A01P': 29, 'C07C': 3008, 'A61L': 2612, 'A21B': 66, 'A21C': 63, 'A23P': 183, 'F41A': 673, 'A22B': 47, 'B25B': 717, 'A22C': 162, 'F16C': 1564, 'A23V': 1071, 'F25D': 1029, 'A23B': 151, 'A23C': 200, 'A23L': 1499, 'G07F': 2064, 'A23G': 248, 'A23K': 321, 'A61P': 11417, 'B65B': 1210, 'B05D': 1071, 'B05B': 1396, 'C08B': 392, 'C08L': 3806, 'A23Y': 67, 'A47J': 1242, 'A24C': 76, 'A24D': 143, 'A24F': 668, 'A61M': 6405, 'F22B': 205, 'F23Q': 72, 'F23C': 160, 'A24B': 198, 'A47F': 522, 'H02J': 4998, 'H01M': 6097, 'Y02E': 12202, 'H02M': 3368, 'H01G': 1226, 'A61B': 17443, 'A41C': 101, 'A41D': 846, 'A41H': 56, 'H05K': 6743, 'F41H': 325, 'A62B': 378, 'A47C': 1041, 'A45C': 555, 'A61F': 5778, 'A41F': 137, 'A42B': 380, 'F16K': 2076, 'A43B': 716, 'D10B': 593, 'D04B': 192, 'A63C': 156, 'A43D': 126, 'B29C': 5827, 'A43C': 230, 'F16F': 1110, 'B29D': 1131, 'G01B': 2509, 'B60R': 4877, 'A44B': 314, 'A45F': 517, 'G04B': 201, 'G04G': 292, 'A44C': 227, 'A45B': 134, 'Y10T': 6017, 'B29K': 2649, 'H04B': 10808, 'A45D': 648, 'B05C': 565, 'A61N': 3045, 'A46B': 473, 'A46D': 78, 'F16B': 1877, 'E04H': 976, 'B65H': 1464, 'F16M': 1098, 'E04G': 422, 'B25H': 247, 'B62H': 108, 'A61G': 878, 'B60N': 1495, 'A61H': 1035, 'F24F': 1689, 'A47D': 138, 'G02F': 5397, 'E05D': 506, 'H04N': 20107, 'G01C': 3342, 'B31F': 112, 'B31D': 91, 'A47L': 1130, 'E04F': 724, 'G01K': 909, 'A23F': 136, 'B67D': 527, 'F24H': 344, 'F24C': 464, 'A01J': 70, 'A47K': 620, 'B02C': 425, 'C12Q': 3183, 'G08C': 683, 'B32B': 4490, 'D21H': 440, 'H02K': 3025, 'Y10S': 1838, 'Y02T': 8528, 'B60L': 2594, 'G01J': 1646, 'B08B': 1133, 'A61C': 956, 'G16H': 4660, 'H01Q': 3186, 'G16Z': 275, 'H04M': 5302, 'H04W': 24742, 'G01R': 5629, 'H01R': 3677, 'B60Y': 1600, 'G06Q': 17036, 'B21D': 748, 'B60H': 822, 'B60K': 3462, 'B60W': 3484, 'B60Q': 1596, 'G09G': 6276, 'H01J': 2505, 'G01T': 637, 'H05G': 257, 'G09B': 1571, 'H10N': 2526, 'B06B': 443, 'B29L': 2607, 'D04H': 316, 'D01D': 291, 'B25C': 153, 'F04C': 624, 'B25G': 174, 'H01L': 22775, 'B33Y': 2233, 'C08J': 2288, 'G02C': 685, 'C03C': 867, 'C03B': 455, 'B21F': 87, 'C22F': 332, 'B31B': 218, 'B41J': 2638, 'B41M': 720, 'B41F': 310, 'B63C': 219, 'A61J': 830, 'A61Q': 1515, 'F21S': 2092, 'C08F': 2277, 'B01J': 3512, 'B82Y': 1722, 'C08G': 2862, 'C07D': 4814, 'C01B': 1870, 'C01P': 1154, 'G10L': 3848, 'C07F': 1242, 'C07H': 591, 'C12Y': 1755, 'C01G': 637, 'G16B': 596, 'C12P': 1336, 'C08K': 2925, 'C07B': 836, 'E03C': 378, 'C11D': 718, 'B03C': 214, 'G01M': 1568, 'G01F': 1336, 'C25B': 368, 'B23K': 2384, 'F16L': 1974, 'H03M': 2430, 'H03K': 3545, 'H04R': 3767, 'G21F': 181, 'A62C': 299, 'B23P': 859, 'B21C': 182, 'E06B': 988, 'G07C': 2344, 'A63F': 2090, 'G01P': 859, 'G10H': 376, 'A63H': 424, 'F21Y': 2393, 'F21V': 3123, 'B60C': 948, 'E01C': 425, 'E01D': 82, 'B64U': 1327, 'B64C': 2862, 'G08G': 3080, 'A63K': 17, 'G06K': 2800, 'Y02D': 4277, 'H04H': 605, 'A63G': 173, 'B63B': 918, 'B01F': 1057, 'F04D': 2023, 'C10G': 982, 'B29B': 594, 'B03D': 59, 'E21B': 4465, 'B21B': 183, 'B04C': 117, 'B22F': 1419, 'C22C': 1543, 'B23Q': 679, 'Y02C': 392, 'F23J': 112, 'C04B': 1455, 'F01N': 1267, 'C09D': 2734, 'Y02W': 1061, 'C23C': 2789, 'C40B': 230, 'B01L': 1525, 'B81C': 551, 'B81B': 735, 'B04B': 120, 'B65F': 206, 'B03B': 60, 'F26B': 331, 'B64D': 2839, 'C09J': 1153, 'F28F': 1113, 'C12H': 55, 'B07B': 156, 'B09B': 148, 'B07C': 217, 'B09C': 82, 'B21H': 40, 'B21J': 230, 'B21K': 144, 'C21D': 686, 'B60P': 734, 'B64F': 681, 'B60G': 628, 'B28B': 404, 'F05D': 3966, 'B22C': 196, 'F01D': 3174, 'B22D': 457, 'H03H': 1404, 'B23B': 572, 'B28D': 155, 'B23C': 236, 'B23D': 361, 'B23G': 37, 'Y04S': 1395, 'F02D': 1859, 'F02N': 384, 'B68G': 55, 'B24B': 635, 'B24D': 168, 'B24C': 107, 'B25F': 394, 'B25D': 149, 'H02P': 1651, 'B27B': 177, 'F16D': 1682, 'B26D': 477, 'F16P': 88, 'B26B': 336, 'B26F': 218, 'B43L': 77, 'B30B': 281, 'G11C': 5323, 'B27N': 82, 'B31C': 8, 'D02J': 40, 'C05D': 90, 'E04B': 1111, 'E04D': 337, 'H01B': 1468, 'H02S': 749, 'H01F': 2244, 'B41N': 50, 'B41C': 50, 'B42D': 323, 'B41P': 67, 'F16J': 803, 'D06P': 148, 'D06B': 88, 'G03G': 2389, 'G09F': 1339, 'C09B': 300, 'G07D': 250, 'B43K': 112, 'B44B': 33, 'B44C': 214, 'B60B': 507, 'B62M': 460, 'B60T': 1129, 'G01H': 401, 'B60S': 506, 'F28D': 1083, 'F01M': 442, 'F02G': 107, 'C09K': 2862, 'B60J': 840, 'B62J': 482, 'F01P': 490, 'F02B': 1415, 'F17C': 409, 'F02M': 1549, 'B62K': 619, 'B61C': 68, 'B60M': 73, 'B61B': 113, 'B61D': 195, 'E05G': 50, 'E05B': 1090, 'B62B': 408, 'H02G': 1173, 'G05F': 985, 'F01K': 341, 'C25D': 632, 'G05G': 295, 'B60D': 208, 'B61L': 270, 'B61G': 32, 'B61K': 50, 'Y02B': 3886, 'E01B': 106, 'E21C': 126, 'H01H': 1484, 'B62L': 117, 'B63H': 403, 'B66C': 438, 'E02F': 733, 'E02B': 255, 'F24S': 327, 'F05B': 938, 'F03B': 232, 'H02N': 382, 'F03D': 790, 'B63G': 132, 'E05C': 372, 'F03G': 218, 'B64G': 351, 'B65C': 122, 'B44D': 71, 'D21J': 27, 'F16G': 225, 'D07B': 111, 'B66B': 380, 'B66D': 210, 'H02H': 1016, 'B67C': 121, 'F25B': 1361, 'C10J': 101, 'H10K': 4995, 'C01F': 242, 'E03F': 217, 'F23D': 314, 'C05G': 144, 'C05B': 65, 'C05F': 149, 'C06B': 58, 'G03F': 2033, 'C11C': 90, 'C10L': 503, 'C10M': 397, 'C10N': 367, 'C09C': 228, 'C08C': 125, 'C07G': 29, 'C08H': 86, 'D21C': 129, 'C01C': 62, 'B44F': 65, 'C09G': 106, 'C23F': 319, 'C10B': 156, 'C11B': 217, 'A23D': 83, 'C12C': 54, 'C13K': 72, 'C07J': 151, 'C12R': 277, 'C21B': 66, 'F27B': 195, 'F27D': 255, 'C22B': 271, 'C23G': 66, 'C21C': 63, 'C30B': 486, 'H01S': 1253, 'E03B': 238, 'D03D': 260, 'D04C': 63, 'D06N': 115, 'D06F': 650, 'D06H': 34, 'D06L': 22, 'D06M': 277, 'D21B': 46, 'D21F': 137, 'D21G': 33, 'E01H': 162, 'E01F': 167, 'F21W': 948, 'E02D': 448, 'E03D': 205, 'E04C': 553, 'E06C': 123, 'B27G': 53, 'B27M': 35, 'B27F': 43, 'B27K': 40, 'H02B': 303, 'F02C': 1994, 'F23R': 512, 'F02K': 672, 'F01L': 516, 'F02F': 338, 'F01C': 176, 'F04F': 112, 'F24D': 242, 'F02P': 301, 'F23K': 87, 'H01T': 165, 'F01B': 113, 'F23N': 180, 'F03C': 58, 'F24T': 28, 'A41B': 169, 'F15D': 105, 'H05H': 396, 'B42P': 33, 'B42F': 50, 'F16N': 209, 'G01D': 1516, 'F17D': 132, 'G03B': 2464, 'F21K': 797, 'H01K': 23, 'F23B': 29, 'F23M': 60, 'F23G': 111, 'F23L': 89, 'F25C': 180, 'F25J': 197, 'F28B': 54, 'F28C': 63, 'F41C': 293, 'F21L': 197, 'F41B': 213, 'F41G': 342, 'F41J': 85, 'F42B': 461, 'F42C': 94, 'G04F': 191, 'F42D': 64, 'G04C': 111, 'H01C': 234, 'B61F': 93, 'H04Q': 1140, 'H10B': 3084, 'G21K': 309, 'D01F': 354, 'G16C': 146, 'G01Q': 124, 'G03H': 320, 'G04R': 66, 'G01W': 193, 'H04J': 1845, 'G21B': 50, 'B42B': 46, 'G04D': 15, 'H03L': 800, 'H03B': 432, 'H03F': 1521, 'G07G': 329, 'G11B': 1948, 'G06G': 63, 'G07B': 206, 'H01P': 852, 'H03D': 128, 'G06J': 9, 'H03G': 551, 'G10G': 83, 'G10C': 37, 'G10D': 210, 'H04S': 890, 'G21H': 20, 'G21C': 267, 'G21G': 75, 'G21D': 70, 'C01D': 105, 'H03J': 78, 'H05F': 52, 'B63J': 73, 'E21F': 59, 'G09C': 263, 'H04K': 129, 'A63J': 62, 'A01L': 9, 'A61D': 115, 'A21D': 101, 'A23J': 76, 'A42C': 19, 'A44D': 56, 'B67B': 86, 'A47H': 62, 'B27C': 33, 'B27L': 25, 'D02G': 163, 'G03C': 22, 'B43M': 20, 'B61H': 49, 'B64B': 57, 'B60F': 39, 'F03H': 33, 'A62D': 64, 'C23D': 6, 'B23F': 55, 'B28C': 56, 'C06D': 12, 'B41K': 24, 'C25C': 83, 'C25F': 84, 'D01H': 49, 'D06C': 47, 'E21D': 94, 'B23H': 89, 'B21L': 4, 'F28G': 49, 'G10F': 9, 'H03C': 51, 'C13B': 14, 'F16T': 27, 'B42C': 47, 'B68C': 6, 'C10K': 81, 'C12G': 58, 'D01G': 23, 'D05B': 125, 'D05D': 51, 'E02C': 1, 'B01B': 10, 'C05C': 99, 'B02B': 7, 'B82B': 51, 'B41G': 1, 'F24V': 19, 'D01C': 7, 'C10C': 26, 'C14C': 20, 'F05C': 61, 'F16S': 7, 'G16Y': 43, 'G06E': 15, 'H05C': 3, 'D05C': 71, 'A41G': 62, 'B21G': 11, 'B41L': 8, 'D06Q': 16, 'B60V': 7, 'C14B': 23, 'D03J': 12, 'D03C': 3, 'D21D': 29, 'F22D': 21, 'F41F': 43, 'G06M': 38, 'G10B': 9, 'G06C': 6, 'B27D': 21, 'G12B': 16, 'F15C': 10, 'A63D': 15, 'C09F': 8, 'D02H': 0, 'D04D': 2, 'F22G': 20, 'F24B': 71, 'C06C': 10, 'D04G': 2, 'C12F': 9, 'G06D': 1, 'B68B': 7, 'B61J': 3, 'G03D': 3, 'G21J': 2, 'H04T': 2, 'C06F': 1, 'F23H': 5, 'B41D': 2, 'C12J': 1, 'D01B': 9, 'B68F': 1, 'D06G': 1, 'C12L': 1, 'B27J': 1, 'F27M': 3, 'H99Z': 0, 'C09H': 1, 'B41B': 0, 'B27H': 0}
